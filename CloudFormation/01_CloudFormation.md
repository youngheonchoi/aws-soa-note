## AWS CloudFormation 정리

---

### 1. 개요

**AWS CloudFormation**은 **코드로 인프라를 정의**하고 **자동으로 프로비저닝**할 수 있는 **Infrastructure as Code (IaC)** 서비스입니다.

---

### 2. CloudFormation이란?

* AWS 리소스를 선언적으로 정의
* 템플릿에 기반해 **자동 생성, 연결, 배포**
* 수동 설정 없이 **완전 자동화된 인프라 구축 가능**
* 인프라 코드화: **재현성, 버전 관리, 변경 추적** 용이

---

### 3. CloudFormation의 장점

| 항목                   | 설명                                 |
| -------------------- | ---------------------------------- |
| **코드로 관리**           | 인프라 구성을 코드(YAML/JSON)로 표현          |
| **버전 제어**            | Git 등의 형상관리 시스템으로 관리 가능            |
| **변경 추적**            | 코드 변경을 통한 인프라 변경 기록                |
| **비용 관리**            | 스택 단위로 리소스 구분 및 비용 추적 가능           |
| **자동 삭제/재배포**        | 예: 퇴근 시 스택 삭제, 출근 시 자동 재생성         |
| **아키텍처 다이어그램 자동 생성** | 시각화 가능 (e.g. Application Composer) |
| **선언형 방식**           | 리소스 생성 순서 신경쓸 필요 없음                |
| **관심사 분리**           | 네트워크, 앱, 데이터베이스 등 스택 분리 가능         |
| **재사용 가능**           | 템플릿 공유 및 수정 용이                     |

---

### 4. CloudFormation 작동 방식

1. 템플릿(YAML/JSON)을 생성
2. 템플릿을 **S3**에 업로드
3. **CloudFormation**이 해당 템플릿을 기준으로 **스택(Stack)** 생성
4. 스택은 정의된 리소스를 생성/변경/삭제

---

### 5. 템플릿 구성 요소

| 섹션                           | 설명                        |
| ---------------------------- | ------------------------- |
| **AWSTemplateFormatVersion** | 템플릿 형식 버전 정의 (optional)   |
| **Description**              | 템플릿 설명                    |
| **Resources**                | 생성할 AWS 리소스 정의 (필수 항목)    |
| **Parameters**               | 사용자 입력 변수 정의 (동적 입력)      |
| **Mappings**                 | 리전별 설정 등 정적 값 매핑          |
| **Conditions**               | 리소스 생성을 위한 조건             |
| **Outputs**                  | 다른 템플릿이나 사용자에게 출력할 정보     |
| **Metadata**                 | 추가적인 설명 또는 정보             |
| **Transform**                | 매크로 또는 SAM 변환 사용 시        |
| **Helpers (Ref, Fn::)**      | 함수 및 참조를 통해 템플릿 내 값 연결 가능 |

---

### 6. 템플릿 배포 방식

| 방식                       | 설명                                                 |
| ------------------------ | -------------------------------------------------- |
| **콘솔 기반 수동 배포**          | 파라미터 수동 입력, 학습용으로 적합                               |
| **자동화 배포**               | CLI 또는 CI/CD 도구(GitHub Actions, CodePipeline 등) 사용 |
| **Application Composer** | 시각적 GUI 기반 템플릿 생성 툴                                |

---

### 7. 스택(Stack) 개념

* 템플릿으로부터 생성된 **AWS 리소스의 집합**
* 리전 내에서 **고유한 이름**을 가짐
* 스택 삭제 시, 생성된 모든 리소스가 함께 삭제됨

---

### 8. 활용 예시

```yaml
Resources:
  MyS3Bucket:
    Type: AWS::S3::Bucket
  MyEC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      InstanceType: t2.micro
      ImageId: ami-12345678
```

* 위 예시는 S3 버킷과 EC2 인스턴스를 선언적으로 정의한 기본 템플릿입니다.

---

### 9. 요약

* CloudFormation은 AWS 인프라 자동화를 위한 **가장 강력한 도구 중 하나**
* 코드로 인프라를 버전 관리하며, **생산성**, **비용 효율**, **보안** 향상
* **템플릿 재사용성, 추적성, 확장성** 면에서 클라우드 개발/운영에 핵심적 역할
