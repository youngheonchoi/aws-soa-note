## EC2 인스턴스 상태 점검 개요

AWS는 EC2 인스턴스의 상태를 자동으로 점검하여 하드웨어 및 소프트웨어 문제를 식별합니다. 상태 점검은 다음과 같이 세 가지 유형으로 구분됩니다.

### 1. 시스템 상태 점검
- AWS 시스템에서 직접 발생하는 문제를 모니터링합니다.
- 물리적 호스트의 소프트웨어 및 하드웨어 문제를 포함합니다.
- 예시: 전원 상실, 호스트 장애 등.
- 해결 방법:
  - **Personal Health Dashboard**를 통해 유지보수 일정 확인.
  - EC2 인스턴스를 중지하고 다시 시작하면 다른 호스트로 자동 마이그레이션됨.
  - 새로운 공용 IP가 할당될 수 있음.

### 2. 인스턴스 상태 점검
- EC2 인스턴스의 소프트웨어 및 네트워크 구성을 점검합니다.
- 예시: 네트워크 구성 오류, 메모리 부족 등.
- 해결 방법:
  - EC2 인스턴스 재부팅.
  - 네트워크 및 소프트웨어 구성 수정.

### 3. 연결된 EBS 상태 점검
- EC2 인스턴스에 연결된 EBS 볼륨의 상태를 점검합니다.
- 접근 가능 여부 및 I/O 작업 가능 여부를 확인합니다.
- 해결 방법:
  - EC2 인스턴스를 재부팅.
  - 영향을 받은 EBS 볼륨을 교체.

<br>

## 상태 점검 자동 복구 방법
AWS는 상태 점검 실패 시 자동 복구를 위한 두 가지 방법을 제공합니다.

### 1. CloudWatch 알람을 활용한 자동 복구
- CloudWatch 지표를 기반으로 상태 점검 결과를 모니터링합니다.
- 시스템 상태 점검 실패, 인스턴스 실패, EBS 연결 실패를 감지할 수 있습니다.
- 상태 점검 실패 시 **CloudWatch 알람**을 설정하여 자동 복구 수행.
- CloudWatch 알람이 SNS를 통해 알림을 전송할 수도 있습니다.

### 2. Auto Scaling Group을 활용한 복구
- 최소, 최대, 원하는 값이 1인 Auto Scaling Group(ASG)을 설정합니다.
- EC2 인스턴스의 상태 점검을 수행하여 문제가 발생하면 종료 후 새로운 인스턴스를 시작합니다.
- 동일한 EBS 볼륨, 동일한 프라이빗 IP를 유지하지만 탄력적 IP는 유지되지 않습니다.
- 자동화 설정을 통해 인스턴스 복구 가능.

<br>

## 결론
- EC2 인스턴스의 상태 점검은 시스템, 인스턴스, EBS 상태 점검으로 구분됩니다.
- 문제 발생 시 인스턴스를 중지하고 재시작하면 자동으로 다른 호스트로 마이그레이션됩니다.
- CloudWatch 알람과 Auto Scaling Group을 활용하여 상태 점검 자동 복구를 설정할 수 있습니다.
- 특정 인스턴스를 유지하려면 **CloudWatch 알람을 활용한 자동 복구**가 적합하며, 일반적인 복구에는 **Auto Scaling Group을 활용한 복구**가 효과적입니다.

<br>

## 반드시 알아야할 내용

### 1. 시스템 상태 확인
시스템 상태 확인은 인스턴스가 실행되는 AWS 시스템을 모니터링합니다.

- 기본 호스트에 문제가 발생했을 때의 예시
  - 네트워크 연결 손실
  - 시스템 전원 손실
  - 물리적 호스트의 소프트웨어 문제
  - 네트워크 접근성에 영향을 미치는 물리적 호스트의 하드웨어 문제
- AWS가 호스트를 고치기를 기다리거나,  
- EC2 인스턴스를 새 호스트로 이동 = 인스턴스 중지 및 시작 (EBS 지원 시)

### 2. 인스턴스 상태 확인
인스턴스 상태 확인은 여러분의 개별 인스턴스의 소프트웨어와 네트워크 구성을 모니터링합니다.

- 문제의 예시
  - 잘못된 네트워킹 또는 시작 구성
  - 메모리 고갈
  - 손상된 파일 시스템
  - 호환되지 않는 커널
- 고치기 위해 사용자의 개입이 필요합니다
- EC2 인스턴스를 다시 시작하거나,
- EC2 인스턴스 구성을 변경하세요.