## AWS 로드 밸런싱 개요

로드 밸런서는 다수의 백엔드 서버(예 : EC2 인스턴스)로 들어오는 **트래픽을 분산**시켜 애플리케이션의 **가용성과 확장성**을 높여주는 서비스입니다. AWS에서는 이를 위해 **Elastic Load Balancer(ELB)** 라는 관리형 서비스를 제공합니다.

<br>

## 로드 밸런서의 작동 방식
- 사용자는 로드 밸런서에 접속하며, 로드 밸런서는 트래픽을 **여러 백엔드 인스턴스 중 하나로 분산**합니다.
- 사용자는 어떤 인스턴스에 연결되었는지 모릅니다. 오직 **단일 접속 지점(DNS 엔드포인트)** 만 인식합니다.
- 로드 밸런서는 각 인스턴스의 **상태 확인**을 수행하고, 비정상 인스턴스에는 트래픽을 보내지 않습니다.

<br>

## 로드 밸런서의 필요성
- **부하 분산**을 통해 시스템 안정성 향상
- 단일 진입점을 통한 **접근 단순화 및 보안 강화**
- **장애 인스턴스 자동 우회** (헬스 체크 기반)
- **HTTPS(SSL 종료)** 지원을 통한 암호화된 통신 가능
- 공용/사설 트래픽 분리
- **고가용성 및 확장성 확보**

<br>

## 주요 기능
- **상태 확인(Health Check)**: 트래픽을 보낼 인스턴스를 판단
  - 예: HTTP 포트 4567, 경로 `/health` 응답 코드가 200이어야 정상
- **SSL 종료**: HTTPS 트래픽을 로드 밸런서에서 복호화
- **스티키 세션**: 쿠키를 기반으로 세션 고정 가능
- **로그 기록**: CloudWatch와 통합 가능
- **서비스 통합**: EC2, Auto Scaling Group, ECS, ACM, Route 53, WAF, Global Accelerator 등과 연동

<br>

## 로드 밸런서 유형 (AWS 기준)

| 유형 | 설명 | 프로토콜 | 특징 |
|------|------|----------|------|
| **CLB (Classic Load Balancer)** | 구세대 로드 밸런서 | HTTP, HTTPS, TCP | 더 이상 추천되지 않음 |
| **ALB (Application Load Balancer)** | 7계층 로드 밸런서 | HTTP, HTTPS, WebSocket | 애플리케이션 기반 라우팅, WAF 지원 |
| **NLB (Network Load Balancer)** | 4계층 고성능 로드 밸런서 | TCP, TLS, UDP | 초고속, 고정 IP 지원 |
| **GWLB (Gateway Load Balancer)** | 보안 어플라이언스 연동용 | 3계층(IP 레벨) | 네트워크 보안 장비와 연동 (2020 출시) |

> 최신 프로젝트에는 ALB 또는 NLB 사용이 권장됩니다.

<br>

## 로드 밸런서 보안 설정

### 🔐 퍼블릭 로드 밸런서
- 보안 그룹:
  - 포트: 80(HTTP), 443(HTTPS)
  - 소스: `0.0.0.0/0` (모든 IP 허용)

### 🔒 백엔드 EC2 인스턴스
- 보안 그룹:
  - 포트: 80 (HTTP)
  - **소스**: 로드 밸런서의 보안 그룹 (IP가 아님)
  - → 외부 접속 차단, **로드 밸런서로부터의 트래픽만 허용**

<br>

## 왜 ELB를 사용해야 할까?
- **AWS가 관리**하는 완전한 관리형 서비스
- 고가용성과 확장성이 자동으로 제공됨
- 자체 구축 대비 **저렴하고 단순**
- 다양한 AWS 서비스와 **심층 통합**
- 다양한 트래픽 및 네트워크 시나리오를 지원하는 **4종의 로드 밸런서 제공**

<br>

## 정리
Elastic Load Balancer는 AWS 환경에서 **트래픽을 안전하고 효율적으로 분산**시키기 위한 핵심 서비스입니다. 사용자는 **하나의 엔드포인트만 관리**하면 되고, 로드 밸런서가 **자동으로 백엔드 인스턴스의 상태를 감지하고 라우팅**을 수행합니다. 보안, 확장성, 고가용성을 모두 만족시켜야 하는 현대적 클라우드 애플리케이션에서 필수적으로 사용됩니다.