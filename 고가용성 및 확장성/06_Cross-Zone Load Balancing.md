## 교차 영역 로드 밸런싱 (Cross-Zone Load Balancing)

**교차 영역 로드 밸런싱**은 로드 밸런서가 **모든 가용 영역(AZ)의 대상 인스턴스에 트래픽을 균등하게 분산**할 수 있게 해주는 기능입니다.  
가용 영역 간의 인스턴스 수가 다르더라도, 전체 트래픽이 **고르게 분산**되도록 돕는 매우 중요한 기능입니다.

<br>

## 개념 설명

### 기본 시나리오
- **AZ1**: EC2 인스턴스 2개  
- **AZ2**: EC2 인스턴스 8개  
- 총 10개의 EC2 인스턴스 존재

> 이때 클라이언트 요청이 두 AZ로 50%씩 도달한다고 가정

### **교차 영역 로드 밸런싱 활성화 시**
- 각 로드 밸런서 인스턴스는 **모든 AZ의 인스턴스에 트래픽 분산**
- 결과적으로 10개의 인스턴스 각각이 전체 요청의 **10%씩** 할당

### **비활성화 시**
- 각 로드 밸런서 인스턴스는 **자기 AZ 안의 인스턴스에만 분산**
- AZ1의 두 인스턴스: 각각 25%씩  
- AZ2의 여덟 인스턴스: 각각 6.25%씩

> AZ마다 인스턴스 수가 다르면 트래픽 부하 불균형 발생 가능

<br>

## 기능별 비교

| 항목 | 교차 영역 로드 밸런싱 `ON` | 교차 영역 로드 밸런싱 `OFF` |
|------|-----------------------------|------------------------------|
| 트래픽 분산 | 모든 AZ에 균등 분산 | 각 AZ 내에서만 분산 |
| 부하 균형 | 인스턴스 수에 관계없이 균형 | 인스턴스 수가 적은 AZ에 더 많은 부하 |
| 데이터 이동 | AZ 간 데이터 전송 발생 | 없음 |

<br>

## 로드 밸런서별 기본 동작

| 로드 밸런서 유형 | 기본 설정 | 변경 가능 여부 | AZ 간 전송 비용 |
|------------------|-----------|----------------|------------------|
| **ALB** (Application) | ✅ 활성화됨 | 대상 그룹에서 `ON/OFF` 선택 가능 | ❌ 없음 |
| **NLB** (Network) | ❌ 비활성화 | 속성에서 수동 활성화 필요 | ✅ 비용 발생 |
| **GWLB** (Gateway) | ❌ 비활성화 | 속성에서 수동 활성화 필요 | ✅ 비용 발생 |
| **CLB** (Classic) | ❌ 비활성화 | 수동 활성화 가능 | ❌ 없음 (비용 없음) |

> ❗ **ALB는 기본적으로 교차 영역 로드 밸런싱이 켜져 있으며, 변경도 가능합니다.**  
> NLB와 GWLB는 꺼져 있고, 활성화 시 **추가 요금**이 발생할 수 있습니다.

<br>

## 설정 위치

### NLB & GWLB
- **Attributes(속성)** 탭 → 편집 → **Cross-Zone Load Balancing: 활성화**
- 안내 메시지: “AZ 간 전송에는 요금이 발생합니다”

### ALB
- 기본 활성화 상태
- **대상 그룹(Target Group)** 속성 편집 시 **별도로 비활성화 가능**

> 타겟 그룹 단위로 **로드 밸런서 설정을 상속**하거나, 직접 `ON/OFF` 지정 가능

<br>

## 사용 시 고려사항
- **인스턴스 수가 불균형한 AZ가 있는 경우**, 교차 영역 로드 밸런싱 활성화가 유리
- **AZ 간 요금**이 신경 쓰인다면, 비활성화 상태로 운영하는 것도 가능
- 트래픽 민감 애플리케이션에서는 **성능보다 비용** 우선 여부를 판단해야 함

<br>

## 정리
**교차 영역 로드 밸런싱**은 하나의 로드 밸런서가 **모든 AZ의 인스턴스로 균등하게 트래픽을 분산**시킬 수 있도록 해주는 기능입니다.  
서비스의 **안정성, 균형 잡힌 부하 분산, 고가용성 확보**를 위해 꼭 이해해야 하는 개념이며, **로드 밸런서 유형에 따라 기본값과 비용 정책이 다르기 때문에** 시험과 실무 모두에서 매우 중요한 주제입니다.