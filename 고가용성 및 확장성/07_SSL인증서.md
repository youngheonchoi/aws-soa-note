## SSL/TLS 인증서란?

**SSL/TLS 인증서**는 클라이언트와 로드 밸런서 사이의 통신을 **암호화**하여 데이터를 보호하는 기술입니다.  
- **SSL (Secure Sockets Layer)**: 초기 암호화 표준  
- **TLS (Transport Layer Security)**: SSL의 최신 버전 (실제로는 TLS 사용 중)  
- 일반적으로 **SSL 인증서**라는 표현을 사용하지만, **TLS 인증서**가 정확한 용어입니다

> 강의에서도 두 용어를 같은 의미로 사용합니다.

<br>

## SSL/TLS의 동작 방식

1. 클라이언트가 **HTTPS 요청** 전송
2. 로드 밸런서가 **SSL 종료(SSL Termination)** 수행
3. 이후 로드 밸런서 → 백엔드 EC2 인스턴스는 일반 HTTP로 통신  
   (→ 내부 VPC 네트워크라 안전)

> 이를 **In-flight 암호화**라고 부르며, 네트워크 상에서의 데이터 암호화를 의미합니다.

<br>

## 인증서의 종류 및 관리

- 인증서는 **공개 인증 기관(CA)** 에서 발급  
  - 예: Comodo, DigiCert, GlobalSign, Let's Encrypt 등
- AWS에서는 **ACM (AWS Certificate Manager)** 를 통해 인증서 발급 및 관리 가능
  - 퍼블릭 인증서 요청
  - 기존 인증서 업로드
- 인증서는 **만료일이 존재**하며, 정기적인 갱신 필요

<br>

## HTTPS 리스너 설정
- HTTPS 리스너를 구성할 때 **인증서 필수 지정**
- ALB와 NLB는 **다중 인증서**와 **다중 리스너**를 지원
- 보안 정책도 지정 가능 (예: TLS 1.2만 허용)

<br>

## SNI (Server Name Indication)

**SNI**는 하나의 로드 밸런서(또는 서버)가 **여러 개의 SSL 인증서를 호스팅**할 수 있도록 하는 기능입니다.

### 작동 방식:
1. 클라이언트가 서버에 접속할 때 **접속하려는 호스트 이름**을 함께 보냄
2. 로드 밸런서는 SNI 정보를 바탕으로 **적절한 인증서**를 선택하여 응답

> 이 과정은 SSL 핸드셰이크의 초기 단계에서 수행됨

### SNI의 주요 장점
- **서버 1대에 여러 도메인 처리 가능**
- 도메인마다 다른 인증서 사용 가능
- 비용 절감 및 구성 단순화

<br>

## SNI 지원 여부

| 로드 밸런서 | SNI 지원 | 다중 인증서 |
|--------------|-----------|---------------|
| **ALB** | ✅ 지원 | ✅ 지원 |
| **NLB** | ✅ 지원 | ✅ 지원 |
| **CLB** | ❌ 미지원 | ❌ (1개 인증서만) |
| **CloudFront** | ✅ 지원 | ✅ 지원 |

> CLB(Classic Load Balancer)는 도메인당 로드 밸런서가 별도로 필요함

<br>

## 예시: ALB와 다중 인증서 구성

```plaintext
ALB
├── 인증서: www.mycorp.com
│   └── 대상 그룹 A
├── 인증서: domain1.example.com
│   └── 대상 그룹 B
```

- 클라이언트가 `www.mycorp.com` 요청 → ALB는 해당 인증서로 응답 후, A 그룹으로 라우팅  
- 클라이언트가 `domain1.example.com` 요청 → 다른 인증서 + B 그룹으로 라우팅

> 모두 **SNI 확장을 통해 구분**됩니다.

<br>

## 정리

| 항목 | 설명 |
|------|------|
| **SSL/TLS 인증서 목적** | HTTPS 암호화를 위한 디지털 신뢰장치 |
| **인증서 관리 도구** | ACM (AWS Certificate Manager) |
| **암호화 위치** | 클라이언트 ↔ 로드 밸런서 구간 |
| **SNI 기능** | 클라이언트가 접속할 도메인을 명시 → 인증서 자동 선택 |
| **ALB/NLB** | SNI 및 다중 인증서 지원 |
| **CLB** | SNI 미지원, 인증서 1개만 가능 |
| **CloudFront** | SNI 및 다중 인증서 지원 |